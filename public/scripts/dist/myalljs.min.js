var rApp=angular.module("meanRestApp",["ngRoute","ngResource"]);rApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"pages/login.html",controller:"loginController",controllerAs:"lController"}).when("/login",{templateUrl:"pages/login.html",controller:"loginController",controllerAs:"lController"}).when("/logout",{templateUrl:"pages/logout.html",controller:"loginController",controllerAs:"lController"}).when("/register",{templateUrl:"pages/register.html",controller:"loginController",controllerAs:"lController"}).when("/console",{templateUrl:"pages/console.html",controller:"consoleController",controllerAs:"cController"}).when("/addTech",{templateUrl:"pages/add.html",controller:"addController",controllerAs:"aController"}).when("/deleteTech/:editTech",{templateUrl:"pages/console.html",controller:"deleteController",controllerAs:"dController"}).when("/editTech/:editTech",{templateUrl:"pages/edit.html",controller:"editController",controllerAs:"eController"})}]),rApp.controller("menuController",["$scope","TechService",function(e,o){e.loginStatus=o.getLoggedIN(),e.username=o.getUsername(),o.subscribe(e,function(){e.loginStatus=o.getLoggedIN(),e.username=o.getUsername()}),e.logoutSubmit=function(){o.setLoggedIN(!1),e.loginStatus=o.getLoggedIN(),o.setUsername(""),e.username=o.getUsername()}}]),rApp.controller("loginController",["$http","TechService","$location",function(e,o,t){var n=this;n.loginSubmit=function(){e({method:"post",url:"/auth",data:n.login,headers:{"Content-Type":"application/vnd.api+json"}}).then(function(e){e.data?(n.message="Login succeessful",o.setLoggedIN(!0),o.setUsername(n.login.loginName),o.notify(),t.path("console")):(n.message="Login Failed",o.setLoggedIN(!1),o.notify()),console.log(n.message)})},n.registerSubmit=function(){e({method:"post",url:"/register",data:n.login,headers:{"Content-Type":"application/vnd.api+json"}}).then(function(e){e.data?(n.message="Registration succeessful",t.path("login")):n.message="Registration Failed",console.log(n.message)})}}]),rApp.controller("consoleController",["$location","TechService","RestService",function(e,o,t){var n=this;n.techRecords=[],n.loginStatus=o.getLoggedIN(),n.techRecords=t.query()}]),rApp.controller("editController",["$routeParams","RestService","$location","TechService",function(e,o,t,n){var l=this;l.loginStatus=n.getLoggedIN(),l.editTech=o.get({tech:e.editTech}),l.editFormSubmit=function(){console.log("to update tech=%s, description=%s",l.editTech.tech,l.editTech.description),o.update({tech:e.editTech},l.editTech),t.path("console")}}]),rApp.controller("addController",["RestService","$location","TechService",function(e,o,t){var n=this;n.addTech={},n.addFormSubmit=function(){console.log("to Save after add tech=%s, description=%s ",n.addTech.tech,n.addTech.description);var t=new e(n.addTech);t.$save(function(){console.log("New record saved successfully"),o.url("console")})}}]),rApp.controller("deleteController",["$routeParams","$location","TechService","RestService",function(e,o,t,n){console.log(" to Delete tech=%s "+e.editTech),n.remove({tech:e.editTech},function(){console.log(e.editTech+" deleted successfully."),o.url("console")})}]),rApp.service("TechService",["$rootScope",function(e){var o=!1,t="";this.getLoggedIN=function(){return o},this.setLoggedIN=function(e){o=e},this.getUsername=function(){return t},this.setUsername=function(e){console.log("setUsername called"),t=e},this.subscribe=function(o,t){var n=e.$on("notifying-service-event",t);o.$on("$destroy",n)},this.notify=function(){e.$emit("notifying-service-event")}}]),rApp.factory("RestService",["$resource",function(e){return e("/api/tech/:tech",null,{update:{method:"PUT"}})}]);